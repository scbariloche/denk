package com.example.andenk.schichtln.modeladapter

import android.app.Activity
import android.content.Context
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import android.widget.ArrayAdapter
import android.widget.TextView
import com.example.andenk.schichtln.R
import com.example.andenk.schichtln.pojos.DayUser
import kotlinx.android.synthetic.main.display_user_list.view.*
import java.text.SimpleDateFormat
import java.util.*

/**
 * Created by andenk on 04.12.2017.
 */


open class UserListAdapter(context: Context?,
                           objects: MutableList<DayUser>?) : ArrayAdapter<DayUser>(context, 0, objects) {


    var objects: MutableList<DayUser>? = objects
    var context: Activity = context as Activity
    var vi: LayoutInflater = context!!.getSystemService(Context.LAYOUT_INFLATER_SERVICE) as LayoutInflater


    override fun getView(position: Int, convertView: View?, parent: ViewGroup): View? {
        var holder: ViewHolder
        var retView: View
        var item: DayUser = objects!!.get(position)
        if (convertView == null) {
            retView = vi.inflate(R.layout.display_user_list, null)
            holder = ViewHolder()

            holder.tvDate = retView.display_userlist_date
            holder.tvType = retView.display_userlist_type

            holder.tvType!!.text = item.type.description

            var sdf = SimpleDateFormat("dd.MM.yy")

            var date = Date(item.day.date)
            holder.tvDate!!.text = sdf.format(date)

            retView.tag = holder //error in this line

        } else {
            holder = convertView.tag as ViewHolder
            retView = convertView
        }

        return retView
    }


//    override fun getView(position: Int, convertView: View, parent: ViewGroup): View {
//        var ret: View
//
//        // Get the data item for this position
//        val item: DayUser? = objects?.get(position)
//        // Check if an existing view is being reused, otherwise inflate the view
//
//        ret = LayoutInflater.from(context).inflate(R.layout.display_user_list, parent, false)
//
//
//        // Lookup view for data population
//        val tvType: TextView? = ret?.findViewById(R.id.display_userlist_type)
//        val tvDate: TextView? = ret?.findViewById(R.id.display_userlist_date)
//
//
//
//        tvDate!!.text = item!!.day.date.toString()
//        tvType!!.text = item!!.type.description
//
//        // Return the completed view to render on screen
//        return ret
//    }

    internal class ViewHolder {
        var tvDate: TextView? = null
        var tvType: TextView? = null
    }
}